<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>免分心搜索启动器</title>
    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
      crossorigin
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <style>
      :root {
        font-family: "Inter", "PingFang SC", "Microsoft YaHei", system-ui, -apple-system,
          BlinkMacSystemFont, "Segoe UI", sans-serif;
      }
      body {
        min-height: 100vh;
        background: #f5f5f7;
        color: #1d1d1f;
      }
      .fade-in {
        animation: fadeIn 0.8s ease forwards;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .glass-shell {
        background: rgba(255, 255, 255, 0.72);
        border-radius: 28px;
        border: 1.5px solid rgba(255, 255, 255, 0.8);
        box-shadow: 0 25px 60px rgba(13, 23, 47, 0.12), 0 5px 18px rgba(15, 23, 42, 0.06);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
      }
      .glass-button {
        background: rgba(255, 255, 255, 0.58);
        border: 2px solid rgba(255, 255, 255, 0.8);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 2px 6px rgba(0, 0, 0, 0.04);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        position: relative;
        overflow: hidden;
      }
      .glass-button::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(0, 122, 255, 0.08), transparent 65%);
        opacity: 0;
        transition: opacity 0.2s ease;
      }
      .glass-button:hover::before {
        opacity: 1;
      }
      .glass-button:hover {
        border-color: rgba(0, 122, 255, 0.6);
        box-shadow: 0 12px 30px rgba(0, 122, 255, 0.12), 0 2px 6px rgba(0, 0, 0, 0.04);
        color: #007aff;
      }
      .glass-button:active {
        transform: scale(0.985);
      }
    </style>
  </head>
  <body class="flex items-center justify-center px-4 py-12">
    <main
      class="glass-shell w-full max-w-[615px] px-8 py-10 space-y-10 fade-in"
    >
      <header class="space-y-4 text-center text-[#1D1D1F]">
        <p class="text-xs tracking-[0.35em] uppercase text-[#86868B]">Focus Mode</p>
        <h1 class="text-[36px] font-semibold tracking-[0.06em]">FOCUS MODE</h1>
        <p class="text-[#86868B] text-sm">
          输入关键词，直达目标平台搜索结果。保持专注，不被信息流打扰。
        </p>
      </header>

      <section class="space-y-4">
        <label for="keyword" class="text-sm font-medium text-[#1D1D1F]"
          >搜索关键词</label
        >
        <div class="relative">
          <input
            id="keyword"
            type="text"
            placeholder="支持中文，回车默认搜索知乎"
            class="w-full rounded-[12px] border-2 border-[#E5E5EA] bg-white px-5 py-4 text-base text-[#1D1D1F] placeholder-[#86868B] transition shadow-sm focus:border-[#007AFF] focus:shadow-[0_0_0_4px_rgba(0,122,255,0.12)] focus:outline-none"
          />
          <button
            id="clearInput"
            class="absolute right-4 top-1/2 -translate-y-1/2 text-[#86868B] hover:text-[#007AFF] transition"
            aria-label="清除输入"
          >
            ✕
          </button>
        </div>
      </section>

      <section aria-label="搜索平台" class="space-y-4">
        <div class="flex items-center justify-between text-[#86868B] text-xs uppercase tracking-[0.3em]">
          <span>快速跳转</span>
          <span>新标签页打开</span>
        </div>
        <div id="platformGrid" class="grid grid-cols-2 gap-4"></div>
      </section>

      <footer class="text-center text-sm text-[#86868B]">
        打开浏览器设置，<span class="text-[#007AFF] font-semibold">添加到桌面</span>
        <div class="mt-1">支持移动端 & 桌面端</div>
      </footer>
    </main>

    <div
      id="toast"
      class="fixed left-1/2 -translate-x-1/2 bottom-6 bg-white border border-white/80 text-[#1D1D1F] px-4 py-3 rounded-2xl text-sm shadow-[0_10px_30px_rgba(15,23,42,0.12)] backdrop-blur-md opacity-0 pointer-events-none transition"
      role="status"
      aria-live="polite"
    ></div>

    <script>
      const DEFAULT_PLATFORM = "zhihu";
      const isMobileDevice = /Android|iPhone|iPad|iPod|Mobile/i.test(
        navigator.userAgent
      );
      const platforms = [
        {
          id: "zhihu",
          label: "知乎",
          url: (encoded) => `https://www.zhihu.com/search?type=content&q=${encoded}`,
          className: "",
        },
        {
          id: "xiaohongshu",
          label: "小红书",
          url: (encoded) =>
            `https://www.xiaohongshu.com/search_result?keyword=${encoded}&source=web_search`,
          mobileUrl: (encoded) =>
            `https://www.xiaohongshu.com/search_result?keyword=${encoded}&source=webapp`,
          deepLink: (encoded, raw) =>
            `xhsdiscover://search/result?keyword=${encodeURIComponent(raw)}`,
          className: "",
        },
        {
          id: "weibo",
          label: "微博",
          url: (encoded) => `https://s.weibo.com/weibo?q=${encoded}`,
          className: "",
        },
        {
          id: "bilibili",
          label: "哔哩哔哩",
          url: (encoded) => `https://search.bilibili.com/all?keyword=${encoded}`,
          className: "",
        },
        {
          id: "taobao",
          label: "淘宝",
          url: (encoded) => `https://s.taobao.com/search?q=${encoded}`,
          className: "",
        },
        {
          id: "pinduoduo",
          label: "拼多多",
          url: (encoded) =>
            `https://mobile.yangkeduo.com/search_result.html?search_key=${encoded}`,
          className: "",
        },
      ];

      const keywordInput = document.getElementById("keyword");
      const clearBtn = document.getElementById("clearInput");
      const toast = document.getElementById("toast");
      const platformGrid = document.getElementById("platformGrid");

      function showToast(message) {
        toast.textContent = message;
        toast.classList.remove("opacity-0");
        toast.classList.add("opacity-100");
        toast.style.pointerEvents = "auto";
        clearTimeout(showToast.timer);
        showToast.timer = setTimeout(() => {
          toast.classList.add("opacity-0");
          toast.classList.remove("opacity-100");
          toast.style.pointerEvents = "none";
        }, 2200);
      }

      function getQuery() {
        return keywordInput.value.trim();
      }

      function closeKeyboard() {
        if (document.activeElement === keywordInput) {
          keywordInput.blur();
        }
        window.scrollTo({ top: 0, behavior: "auto" });
      }

      function handleVisibilityReturn() {
        if (!document.hidden) {
          closeKeyboard();
        }
      }

      document.addEventListener("visibilitychange", handleVisibilityReturn);
      window.addEventListener("pageshow", handleVisibilityReturn);

      function openNewTab(url) {
        window.open(url, "_blank", "noopener");
      }

      function invokeDeepLink(url) {
        if (!url) return;
        try {
          const iframe = document.createElement("iframe");
          iframe.style.display = "none";
          iframe.src = url;
          document.body.appendChild(iframe);
          setTimeout(() => {
            iframe.remove();
          }, 1500);
        } catch (error) {
          console.warn("Unable to trigger deep link", error);
        }
      }

      function openSearch(platformId) {
        const query = getQuery();
        if (!query) {
          showToast("请输入关键词再搜索");
          keywordInput.focus();
          return;
        }

        const platform = platforms.find((p) => p.id === platformId) || platforms[0];
        const encoded = encodeURIComponent(query);
        const fallbackUrl = platform.url(encoded, query);
        const mobileUrl =
          isMobileDevice && typeof platform.mobileUrl === "function"
            ? platform.mobileUrl(encoded, query)
            : null;
        const targetUrl = mobileUrl || fallbackUrl;

        closeKeyboard();

        if (isMobileDevice && typeof platform.deepLink === "function") {
          invokeDeepLink(platform.deepLink(encoded, query));
        }

        openNewTab(targetUrl);
      }

      function renderButtons() {
        const fragment = document.createDocumentFragment();
        platforms.forEach((platform) => {
          const button = document.createElement("button");
          button.type = "button";
          button.dataset.platform = platform.id;
          button.className = [
            "glass-button group w-full min-h-[90px] rounded-[16px] text-[17px] font-semibold tracking-[0.02em] flex items-center justify-center text-[#1D1D1F] hover:text-[#007AFF] transition-all duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-[#007AFF]/60 focus-visible:ring-offset-2 focus-visible:ring-offset-transparent",
            platform.className,
          ]
            .filter(Boolean)
            .join(" ");
          button.textContent = platform.label;
          button.addEventListener("click", () => openSearch(platform.id));
          fragment.appendChild(button);
        });
        platformGrid.appendChild(fragment);
      }

      keywordInput.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
          event.preventDefault();
          openSearch(DEFAULT_PLATFORM);
        }
      });

      clearBtn.addEventListener("click", () => {
        keywordInput.value = "";
        if (!isMobileDevice) {
          keywordInput.focus();
        }
      });

      renderButtons();
    </script>
  </body>
</html>

