<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>免分心搜索启动器</title>
    <link
      rel="preconnect"
      href="https://fonts.googleapis.com"
      crossorigin
    />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <style>
      :root {
        font-family: "Inter", "PingFang SC", "Microsoft YaHei", system-ui, -apple-system,
          BlinkMacSystemFont, "Segoe UI", sans-serif;
      }
      body {
        min-height: 100vh;
        background: #F5F5F7;
      }
      .fade-in {
        animation: fadeIn 0.8s ease forwards;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body class="flex items-center justify-center px-4 py-10">
    <main
      class="w-full max-w-[615px] px-6 fade-in"
    >
      <header class="text-center mb-10">
        <h1 class="text-[#1D1D1F] mb-4" style="font-size: 36px; font-weight: 600; letter-spacing: 2px;">
          FOCUS MODE
        </h1>
        <p class="text-[#86868B]" style="font-size: 15px; font-weight: 400;">
          输入关键词，直达目标平台搜索结果。保持专注，不被信息流打扰。
        </p>
      </header>

      <section class="mb-6">
        <label for="keyword" class="block text-[#1D1D1F] mb-3" style="font-size: 14px; font-weight: 500;"
          >搜索关键词</label
        >
        <div class="relative">
          <input
            id="keyword"
            type="text"
            placeholder="支持中文，回车默认搜索知乎"
            class="w-full px-5 py-4 bg-[#E5E5EA] text-[#1D1D1F] placeholder-[#86868B] rounded-[12px] border-none outline-none transition-all duration-200 focus:bg-[#D1D1D6]"
            style="font-size: 15px; font-weight: 400;"
          />
          <button
            id="clearInput"
            class="absolute right-4 top-1/2 -translate-y-1/2 text-[#86868B] hover:text-[#1D1D1F] transition-colors"
            aria-label="清除输入"
            style="font-size: 18px; line-height: 1;"
          >
            ✕
          </button>
        </div>
      </section>

      <section aria-label="搜索平台" class="mb-8">
        <div class="flex items-center justify-between mb-4">
          <span class="text-[#1D1D1F]" style="font-size: 14px; font-weight: 500;">快速跳转</span>
          <span class="text-[#86868B]" style="font-size: 13px; font-weight: 400;">新标签页打开</span>
        </div>
        <div id="platformGrid" class="grid grid-cols-2 gap-4"></div>
      </section>

      <footer class="text-center text-[#86868B]" style="font-size: 13px; font-weight: 400;">
        默认回车搜索: <span class="text-[#007AFF]" style="font-weight: 500;">知乎</span> · 支持移动端 & 桌面端
      </footer>
    </main>

    <div
      id="toast"
      class="fixed left-1/2 -translate-x-1/2 bottom-6 bg-[#1D1D1F]/90 text-white px-4 py-3 rounded-2xl text-sm shadow-lg backdrop-blur-md opacity-0 pointer-events-none transition"
      role="status"
      aria-live="polite"
    ></div>

    <script>
      const DEFAULT_PLATFORM = "zhihu";
      const isMobileDevice = /Android|iPhone|iPad|iPod|Mobile/i.test(
        navigator.userAgent
      );
      const platforms = [
        {
          id: "zhihu",
          label: "知乎",
          url: (encoded) => `https://www.zhihu.com/search?type=content&q=${encoded}`,
          className: "bg-blue-600 hover:bg-blue-500",
        },
        {
          id: "xiaohongshu",
          label: "小红书",
          url: (encoded) =>
            `https://www.xiaohongshu.com/search_result?keyword=${encoded}&source=web_search`,
          mobileUrl: (encoded) =>
            `https://www.xiaohongshu.com/search_result?keyword=${encoded}&source=webapp`,
          deepLink: (encoded, raw) =>
            `xhsdiscover://search/result?keyword=${encodeURIComponent(raw)}`,
          className: "bg-red-500 hover:bg-red-400",
        },
        {
          id: "weibo",
          label: "微博",
          url: (encoded) => `https://s.weibo.com/weibo?q=${encoded}`,
          className: "bg-yellow-500 text-slate-900 hover:bg-yellow-400",
        },
        {
          id: "bilibili",
          label: "哔哩哔哩",
          url: (encoded) => `https://search.bilibili.com/all?keyword=${encoded}`,
          className: "bg-pink-600 hover:bg-pink-500",
        },
        {
          id: "taobao",
          label: "淘宝",
          url: (encoded) => `https://s.taobao.com/search?q=${encoded}`,
          className: "bg-orange-500 hover:bg-orange-400",
        },
        {
          id: "pinduoduo",
          label: "拼多多",
          url: (encoded) =>
            `https://mobile.yangkeduo.com/search_result.html?search_key=${encoded}`,
          className: "bg-rose-500 hover:bg-rose-400",
        },
      ];

      const keywordInput = document.getElementById("keyword");
      const clearBtn = document.getElementById("clearInput");
      const toast = document.getElementById("toast");
      const platformGrid = document.getElementById("platformGrid");

      function showToast(message) {
        toast.textContent = message;
        toast.classList.remove("opacity-0");
        toast.classList.add("opacity-100");
        toast.style.pointerEvents = "auto";
        clearTimeout(showToast.timer);
        showToast.timer = setTimeout(() => {
          toast.classList.add("opacity-0");
          toast.classList.remove("opacity-100");
          toast.style.pointerEvents = "none";
        }, 2200);
      }

      function getQuery() {
        return keywordInput.value.trim();
      }

      function closeKeyboard() {
        if (document.activeElement === keywordInput) {
          keywordInput.blur();
        }
        window.scrollTo({ top: 0, behavior: "auto" });
      }

      function handleVisibilityReturn() {
        if (!document.hidden) {
          closeKeyboard();
        }
      }

      document.addEventListener("visibilitychange", handleVisibilityReturn);
      window.addEventListener("pageshow", handleVisibilityReturn);

      function openNewTab(url) {
        window.open(url, "_blank", "noopener");
      }

      function invokeDeepLink(url) {
        if (!url) return;
        try {
          const iframe = document.createElement("iframe");
          iframe.style.display = "none";
          iframe.src = url;
          document.body.appendChild(iframe);
          setTimeout(() => {
            iframe.remove();
          }, 1500);
        } catch (error) {
          console.warn("Unable to trigger deep link", error);
        }
      }

      function openSearch(platformId) {
        const query = getQuery();
        if (!query) {
          showToast("请输入关键词再搜索");
          keywordInput.focus();
          return;
        }

        const platform = platforms.find((p) => p.id === platformId) || platforms[0];
        const encoded = encodeURIComponent(query);
        const fallbackUrl = platform.url(encoded, query);
        const mobileUrl =
          isMobileDevice && typeof platform.mobileUrl === "function"
            ? platform.mobileUrl(encoded, query)
            : null;
        const targetUrl = mobileUrl || fallbackUrl;

        closeKeyboard();

        if (isMobileDevice && typeof platform.deepLink === "function") {
          invokeDeepLink(platform.deepLink(encoded, query));
        }

        openNewTab(targetUrl);
      }

      function renderButtons() {
        const fragment = document.createDocumentFragment();
        platforms.forEach((platform) => {
          const button = document.createElement("button");
          button.type = "button";
          button.dataset.platform = platform.id;
          button.className = "group relative overflow-hidden rounded-[16px] px-6 py-6 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] focus:outline-none";
          button.style.cssText = `
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid rgba(255, 255, 255, 0.8);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05), 0 2px 6px rgba(0, 0, 0, 0.03);
          `;
          
          const span = document.createElement("span");
          span.className = "relative z-10 text-[#1D1D1F] transition-transform duration-300 group-hover:scale-105 block";
          span.style.cssText = "font-size: 17px; font-weight: 600; letter-spacing: 0.5px;";
          span.textContent = platform.label;
          
          const hoverEffect = document.createElement("div");
          hoverEffect.className = "absolute inset-0 bg-gradient-to-br from-white/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300";
          
          button.appendChild(span);
          button.appendChild(hoverEffect);
          button.addEventListener("click", () => openSearch(platform.id));
          fragment.appendChild(button);
        });
        platformGrid.appendChild(fragment);
      }

      keywordInput.addEventListener("keydown", (event) => {
        if (event.key === "Enter") {
          event.preventDefault();
          openSearch(DEFAULT_PLATFORM);
        }
      });

      clearBtn.addEventListener("click", () => {
        keywordInput.value = "";
        if (!isMobileDevice) {
          keywordInput.focus();
        }
      });

      window.addEventListener("load", () => {
        if (!isMobileDevice) {
          keywordInput.focus({ preventScroll: true });
        }
      });

      renderButtons();
    </script>
  </body>
</html>

